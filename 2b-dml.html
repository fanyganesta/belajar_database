<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Type</title>
    <link rel="stylesheet" href="css/index.css">
</head>
<body>
    <div class="container">
        <aside id="aside">

        </aside>

        <main>
            <header>
                
            </header>
            
            <div class="content">
                
                BAB 2.2 ‚Äî DML (Data Manipulation Language)

                Kalau:

                DDL = bikin rumah

                DML = ngisi, mindahin, dan beresin barang di rumah itu

                Di sinilah kamu bakal paling sering ngetik SQL di dunia nyata.

                A. Apa itu DML?

                DML = perintah SQL untuk mengelola ISI data di tabel

                Yang termasuk DML:

                INSERT ‚Üí masukin data

                UPDATE ‚Üí ubah data

                DELETE ‚Üí hapus data

                SELECT ‚Üí ambil data (query)

                üìå DML tidak mengubah struktur, tapi mengubah data

                B. Karakteristik DML (beda sama DDL)

                Bisa kena banyak row

                Bisa dibatasi pakai WHERE

                Bisa di-rollback kalau pakai transaction

                Paling rawan bug kalau WHERE salah

                üî• Kesalahan DML = data salah
                Kesalahan DDL = sistem rusak

                C. Urutan Logis DML

                Di aplikasi nyata:

                INSERT (data masuk)

                SELECT (data ditampilkan)

                UPDATE (data berubah)

                DELETE (data dibersihkan)

                Makanya kita mulai dari INSERT

                2.2.1 INSERT ‚Äî Memasukkan Data ke Tabel
                A. Bentuk Dasar INSERT (WAJIB HAFAL)
                INSERT INTO nama_tabel (kolom1, kolom2, kolom3)
                VALUES (nilai1, nilai2, nilai3);


                Contoh:

                INSERT INTO users (email, name, password)
                VALUES ('a@b.com', 'Fany', 'hashed_password');

                B. INSERT Tanpa Sebut Kolom (‚ö†Ô∏è HATI-HATI)
                INSERT INTO users
                VALUES (1, 'a@b.com', 'Fany', 'hashed_password');


                ‚ùå Tidak direkomendasikan, karena:

                Bergantung urutan kolom

                ALTER TABLE ‚Üí error

                Best practice: SELALU sebut kolom

                C. INSERT Multiple Rows (lebih efisien)
                INSERT INTO users (email, name)
                VALUES
                ('a@b.com', 'A'),
                ('b@b.com', 'B'),
                ('c@b.com', 'C');


                Lebih cepat dari banyak INSERT satu-satu.

                D. INSERT dengan DEFAULT Value

                Jika kolom punya DEFAULT:

                INSERT INTO users (email, name)
                VALUES ('x@y.com', 'X');


                Kolom lain otomatis:

                created_at

                is_active

                dll

                E. INSERT dengan AUTO_INCREMENT
                INSERT INTO users (email, name)
                VALUES ('c@d.com', 'C');


                id akan otomatis diisi MySQL.

                F. INSERT dari SELECT (LEVEL PRO)
                INSERT INTO archived_users (email, name)
                SELECT email, name
                FROM users
                WHERE is_active = 0;


                Dipakai untuk:

                Backup

                Archiving

                Migration data

                G. INSERT + UNIQUE (error handling)

                Jika kolom UNIQUE:

                INSERT INTO users (email, name)
                VALUES ('a@b.com', 'Duplicate');


                üëâ ERROR: duplicate key

                Solusi 1: IGNORE
                INSERT IGNORE INTO users (email, name)
                VALUES ('a@b.com', 'Duplicate');


                ‚ö†Ô∏è Data diabaikan diam-diam

                Solusi 2: ON DUPLICATE KEY UPDATE
                INSERT INTO users (email, name)
                VALUES ('a@b.com', 'Updated')
                ON DUPLICATE KEY UPDATE
                name = VALUES(name);


                üî• Banyak dipakai di sistem sync

                H. INSERT + FOREIGN KEY
                INSERT INTO orders (user_id, total)
                VALUES (999, 100000);


                Jika user_id tidak ada di users:
                ‚ùå ERROR (FK constraint)

                üëâ Integritas data terjaga

                I. Kesalahan Fatal Pemula ‚ùå

                ‚ùå INSERT tanpa kolom
                ‚ùå Nilai tidak sesuai tipe data
                ‚ùå Lupa constraint UNIQUE / FK
                ‚ùå Masukin data mentah tanpa validasi aplikasi

                J. Checklist Aman INSERT

                Sebelum INSERT:

                Kolom wajib sudah diisi?

                Tipe data sesuai?

                UNIQUE aman?

                FK valid?

                K. Mini Latihan üî•

                Asumsi tabel products:

                id, name, price, stock, is_active, created_at


                Tugas:

                INSERT 1 produk

                INSERT 3 produk sekaligus

                INSERT produk tanpa isi is_active & created_at

                <br> <br>

                <hr>

                <br> <br>

                2.2.2 UPDATE ‚Äî Mengubah Data Tanpa Nyesel
                A. Apa itu UPDATE?

                UPDATE dipakai untuk mengubah data yang SUDAH ADA di tabel.

                UPDATE nama_tabel
                SET kolom = nilai
                WHERE kondisi;


                ‚ö†Ô∏è Tanpa WHERE = semua data berubah

                B. Contoh UPDATE Paling Dasar
                UPDATE users
                SET name = 'Fany'
                WHERE id = 1;


                Artinya:

                Cari user id = 1

                Ubah name

                C. UPDATE Banyak Kolom Sekaligus
                UPDATE users
                SET
                    name = 'Fany Ganesta',
                    is_active = 1
                WHERE id = 1;

                D. UPDATE Tanpa WHERE (INI DOSA BESAR)
                UPDATE users
                SET is_active = 0;


                üî• Semua user nonaktif
                üî• Pernah kejadian di production dunia nyata

                Senior rule:
                SELECT dulu, baru UPDATE

                E. Pola Aman UPDATE (WAJIB DIPAKAI)
                Step 1: SELECT dulu
                SELECT * FROM users WHERE id = 1;

                Step 2: Kalau benar ‚Üí UPDATE
                UPDATE users
                SET is_active = 0
                WHERE id = 1;

                F. UPDATE dengan Kondisi Kompleks
                UPDATE orders
                SET status = 'cancelled'
                WHERE status = 'pending'
                AND created_at < NOW() - INTERVAL 7 DAY;


                Dipakai untuk:

                auto-cancel

                cleanup data

                G. UPDATE + LIMIT (MySQL Spesifik)
                UPDATE users
                SET is_active = 0
                ORDER BY created_at ASC
                LIMIT 10;


                ‚ö†Ô∏è MySQL-only
                ‚ö†Ô∏è Hati-hati di production

                H. UPDATE Berdasarkan Tabel Lain (JOIN)

                üî• LEVEL PRO

                UPDATE orders o
                JOIN users u ON o.user_id = u.id
                SET o.status = 'blocked'
                WHERE u.is_active = 0;


                Dipakai untuk:

                sinkron status

                data cleanup

                I. UPDATE + UNIQUE Constraint
                UPDATE users
                SET email = 'a@b.com'
                WHERE id = 2;


                Jika email sudah ada:
                ‚ùå ERROR duplicate key

                üëâ Database menjaga integritas

                J. UPDATE + NULL

                Set ke NULL:

                UPDATE users
                SET phone = NULL
                WHERE id = 1;


                Kalau kolom NOT NULL:
                ‚ùå ERROR

                K. UPDATE dalam Transaction (LEVEL AMAN)
                START TRANSACTION;

                UPDATE users SET is_active = 0 WHERE id = 1;

                -- cek dulu
                SELECT * FROM users WHERE id = 1;

                COMMIT;   -- simpan
                -- atau
                ROLLBACK; -- batal


                üî• Ini kebiasaan senior

                L. Kesalahan Fatal Pemula ‚ùå

                ‚ùå UPDATE tanpa WHERE
                ‚ùå Salah kondisi WHERE
                ‚ùå Tidak cek data sebelum UPDATE
                ‚ùå UPDATE massal di jam sibuk

                M. Checklist Aman UPDATE

                Sebelum tekan Enter:

                Sudah SELECT dulu?

                WHERE spesifik?

                Pakai PK?

                Perlu transaction?

                N. Mini Latihan üî•

                Tabel products:

                id, name, price, stock, is_active


                Tugas:

                Update harga produk id = 5

                Nonaktifkan semua produk dengan stock = 0

                Tambah stock +10 untuk produk tertentu

                <br> <br>

                <hr>

                <br> <br>

                2.2.3 DELETE ‚Äî Menghapus Data Tanpa Bikin Kuburan Massal
                A. Apa itu DELETE?

                DELETE digunakan untuk menghapus data (row) dari tabel.

                DELETE FROM nama_tabel
                WHERE kondisi;


                üìå Struktur tabel tetap ada
                üìå Yang hilang cuma datanya

                B. DELETE vs DROP vs TRUNCATE (recap cepat)
                Perintah	Efek	Bisa Rollback
                DELETE	Hapus row tertentu	‚úÖ (transaction)
                TRUNCATE	Hapus semua row	‚ùå
                DROP	Hapus tabel	‚ùå
                C. DELETE Paling Dasar
                DELETE FROM users
                WHERE id = 10;


                Hapus 1 baris spesifik

                D. DELETE Tanpa WHERE = Bencana
                DELETE FROM users;


                üî• Semua data hilang
                üî• Pernah bikin startup rollback database

                Rule emas:
                DELETE TANPA WHERE = SALAH BESAR

                E. Pola Aman DELETE (WAJIB)
                Step 1: SELECT dulu
                SELECT * FROM users WHERE is_active = 0;

                Step 2: DELETE kalau yakin
                DELETE FROM users WHERE is_active = 0;

                F. DELETE dengan Kondisi Kompleks
                DELETE FROM orders
                WHERE status = 'cancelled'
                AND created_at < NOW() - INTERVAL 1 YEAR;


                Dipakai untuk:

                data cleanup

                archiving

                G. DELETE + LIMIT (MySQL Spesifik)
                DELETE FROM logs
                ORDER BY created_at ASC
                LIMIT 1000;


                Dipakai untuk:

                hapus bertahap

                hindari lock besar

                H. DELETE dengan JOIN (LEVEL PRO)
                DELETE o
                FROM orders o
                JOIN users u ON o.user_id = u.id
                WHERE u.is_active = 0;


                Hapus order milik user nonaktif.

                ‚ö†Ô∏è Sangat powerful ‚Üí sangat berbahaya

                I. DELETE + FOREIGN KEY

                Jika tabel direferensikan:

                DELETE FROM users WHERE id = 1;


                Jika ada order milik user tsb:

                ‚ùå ERROR (default)

                atau:

                ON DELETE CASCADE

                ON DELETE SET NULL

                üìå FK rules menentukan perilaku

                J. Soft Delete (BEST PRACTICE)

                üî• Di aplikasi nyata, jarang pakai DELETE langsung

                Pola soft delete
                UPDATE users
                SET deleted_at = NOW()
                WHERE id = 1;


                Keuntungan:

                Data aman

                Bisa restore

                Audit trail

                Framework seperti Laravel pakai ini.

                K. DELETE dalam Transaction (SUPER AMAN)
                START TRANSACTION;

                DELETE FROM users WHERE id = 5;

                SELECT * FROM users WHERE id = 5;

                ROLLBACK; -- kalau salah
                -- COMMIT; -- kalau yakin

                L. Kesalahan Fatal Pemula ‚ùå

                ‚ùå DELETE tanpa WHERE
                ‚ùå Salah kondisi WHERE
                ‚ùå Tidak cek FK
                ‚ùå Hapus data bisnis penting permanen

                M. Checklist Aman DELETE

                Sebelum execute:

                Sudah SELECT dulu?

                WHERE spesifik?

                FK aman?

                Lebih baik soft delete?

                N. Mini Latihan üî•

                Tabel products:

                id, name, stock, is_active, deleted_at


                Tugas:

                Soft delete produk id = 3

                Hapus permanen produk yang deleted_at lebih dari 2 tahun

                Hapus 100 data log terlama
                
                <a href="2b-dml.html" class="btn-next">2b. DDL</a>
            </div>
        </main>
    </div>

    <script>
        fetch('layout/aside.html').then(response => response.text()).then(data => {
            document.getElementById('aside').innerHTML = data;

            const currentPage = window.location.pathname.split('/').pop();
            const links = document.querySelectorAll('aside a');

            links.forEach(link => {
                if(link.getAttribute('href') == currentPage){
                    link.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>