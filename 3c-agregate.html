<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Type</title>
    <link rel="stylesheet" href="css/index.css">
</head>
<body>
    <div class="container">
        <aside id="aside">

        </aside>

        <main>
            <header>
                
            </header>
            
            <div class="content">
                <h2>.3 APA ITU AGGREGATE FUNCTION?</h2>

                <p>Aggregate function itu fungsi SQL yang:</p>

                <div class="quote"><p>mengambil banyak baris ‚Üí menghasilkan 1 nilai ringkasan</p></div>

                <p>Kalau SELECT biasa itu:
                <ul>
                    <li>fokus ke baris per baris</li>
                </ul> <br>
                

                Kalau aggregate:
                <ul>
                    <li>fokus ke keseluruhan data / kelompok data</li>
                </ul> <br>
                

                Contoh dunia nyata:

                <div class="quote"><p>Bukan ‚Äúini transaksi apa‚Äù</p></div> <br>

                Tapi:
                <ul>
                    <li>berapa jumlah transaksi</li>
                    <li>total uang masuk</li>
                    <li>rata-rata penjualan</li>
                    <li>berapa transaksi per user</li>
                </ul></p>

                <br> <hr> <br>

                <h3>A. üîß Fungsi Aggregate Utama</h3>

                <p>Yang akan kita bahas di 3.3:
                <ul>
                    <li><code>COUNT()</code> ‚Üí menghitung jumlah</li>
                    <li><code>SUM()</code> ‚Üí menjumlahkan nilai</li>
                    <li><code>AVG()</code> ‚Üí rata-rata</li>
                    <li><code>GROUP BY</code> ‚Üí mengelompokkan data</li>
                    <li><code>HAVING</code> ‚Üí filter hasil aggregate</li>
                </ul> <br>

                Hari ini kita fokus dulu ke pondasinya: <code>COUNT()</code></p>

                <br> <hr> <br>

                <h3>B. üß† CARA BERPIKIR AGGREGATE (PENTING!)</h3>

                <p>Biasanya flow berpikirnya begini:</p>

                <div class="quote"><p>‚ÄúDari sekumpulan data ini, aku pengen tahu ringkasannya apa?‚Äù</p></div>

                <p>Contoh: <br> <br>

                Dari tabel orders:
                <ul>
                    <li>ada berapa order</li>
                    <li>tiap user punya berapa order</li>
                    <li>tiap produk terjual berapa kali</li>
                </ul> <br> <br>
                

                Nah‚Ä¶ begitu kamu mikir ‚Äúberapa‚Äù, ‚Äútotal‚Äù, ‚Äúrata-rata‚Äù <br>
                ‚û°Ô∏è itu alarm aggregate üö®</p>

                <br> <hr> <br>

                <h2>3.3.1 COUNT() ‚Äî MENGHITUNG DATA</h2>
                <h3>A. üîπ Fungsi dasar</h3>
<pre>       
    COUNT()
</pre>     

                <p>Digunakan untuk:
                <ul>
                    <li>menghitung jumlah baris</li>
                    <li>menghitung jumlah data yang tidak NULL</li>
                </ul></p>

                <br> <hr> <br>

                <h3>B. ‚úÖ CONTOH TABEL</h3>

                <p>Misal tabel orders:</p>

                <table>
                    <tr>
                        <th>id</th>
                        <th>user_id</th>
                        <th>total</th>
                        <th>status</th>
                    </tr>
                    <tr>
                        <td class="ct">1</td>
                        <td class="ct">1</td>
                        <td>100000</td>
                        <td class="ct">paid</td>
                    </tr>
                    <tr>
                        <td class="ct">2</td>
                        <td class="ct">1</td>
                        <td>150000</td>
                        <td class="ct">paid</td>
                    </tr>
                    <tr>
                        <td class="ct">3</td>
                        <td class="ct">2</td>
                        <td>200000</td>
                        <td class="ct">unpaid</td>
                    </tr>
                    <tr>
                        <td class="ct">4</td>
                        <td class="ct">3</td>
                        <td><code>NULL</code></td>
                        <td class="ct">paid</td>
                    </tr>
                </table>

                <br> <hr> <br>
                
                <h4>üîπ 1. COUNT(*) ‚Äî hitung semua baris</h4>
<pre>            
    SELECT COUNT(*) FROM orders;
</pre>

                <p>üß† Artinya:</p>

                <div class="quote"><p>‚ÄúAda berapa baris di tabel orders?‚Äù</p></div>

                <p>üìå Hasil:</p>
<pre>
    4
</pre>

                <p>‚û°Ô∏è <code>COUNT(*)</code> TIDAK PEDULI <code>NULL</code></p>

                <br> <hr> <br>

                <h4>üîπ 2. COUNT(nama_kolom)</h4>
<pre>
    SELECT COUNT(total) FROM orders;
</pre>

                <p>üß† Artinya:</p>

                <div class="quote"><p>‚ÄúAda berapa baris yang kolom total-nya tidak <code>NULL</code>?‚Äù</p></div>

                <p>üìå Hasil:</p>
<pre>
    3
</pre>

                <p>(baris ke-4 total = NULL, jadi tidak dihitung)</p>

                <br> <hr> <br>

                <h4>‚ö†Ô∏è PERBEDAAN </h4>
                <table>
                    <tr>
                        <th>Query</th>
                        <th>Menghitung</th>
                    </tr>
                    <tr>
                        <td><code>COUNT(*)</code></td>
                        <td>Semua baris</td>
                    </tr>
                    <tr>
                        <td><code>COUNT(kolom)</code></td>
                        <td>Baris yang kolomnya tidak <code>NULL</code></td>
                    </tr>
                </table> <br>

                <p>Ini sering jadi jebakan Batman ü¶á di dunia kerja.</p>

                <br> <hr> <br>

                <h4>üîπ 3. COUNT dengan WHERE</h4>
<pre>
    SELECT COUNT(*)  <br>
    FROM orders <br>
    WHERE status = 'paid';
</pre>

                <p>üß† Artinya:</p>

                <div class="quote"><p>‚ÄúAda berapa order yang statusnya paid?‚Äù</p></div>

                <p>üìå Hasil:</p>
<pre>
    3
</pre>

                <p>‚û°Ô∏è WHERE jalan dulu, baru COUNT</p>

                <br> <hr> <br>

                <h4>üîπ 4. COUNT + JOIN (real world banget)</h4>
<pre>
    SELECT COUNT(orders.id)  <br>
    FROM users <br>
    LEFT JOIN orders ON users.id = orders.user_id;
</pre>

                <p>Dipakai buat:
                <ul>
                    <li>hitung jumlah order</li>
                    <li>hitung relasi antar tabel</li>
                </ul> <br>
                
                Nanti ini bakal makin cakep pas digabung GROUP BY üî•</p>

                <br> <hr> <br>

                <h3>C. üß™ USE CASE NYATA COUNT()</h3>

                <p>Contoh pertanyaan bisnis:
                <ul>
                    <li>Berapa total user?</li>
                    <li>Berapa order hari ini?</li>
                    <li>Berapa produk terjual?</li>
                    <li>Berapa transaksi per user?</li>
                </ul> <br>

                ‚û°Ô∏è Jawabannya selalu mulai dari COUNT</p>

                <br> <hr> <br>

                <h3>D. üß† RANGKUMAN COUNT()</h3>
                <ul>
                    <li><code>COUNT(*)</code> ‚Üí hitung baris</li>
                    <li><code>COUNT(kolom)</code> ‚Üí hitung data tidak NULL</li>
                </ul> <br>
                
                <p>Bisa digabung:
                <ul>
                    <li><code>WHERE</code></li>
                    <li><code>JOIN</code></li>
                    <li>(sebentar lagi) GROUP BY</li>
                </ul></p>

                <br> <br>

                <hr>

                <br> <br>

                <h2>3.3.2 SUM()</h2>

                <h3>APA ITU SUM()?</h3>

                <div class="quote"><p><code>SUM()</code> adalah aggregate function buat: <br> <br>

                menjumlahkan nilai numerik dari banyak baris</p></div>

                <p>Kalau COUNT() jawab:
                <ul>
                    <li>‚Äúada berapa?‚Äù</li>
                </ul> <br> <br>
                

                Maka SUM() jawab:
                <ul>
                    <li>‚Äútotalnya berapa?‚Äù</li>
                </ul></p>
                

                <br> <hr> <br>

                <h3>A. üß† CARA BERPIKIR SUM()</h3>

                <p>Biasanya kepake kalau kamu mikir:
                <ul>
                    <li>total penjualan</li>
                    <li>total pengeluaran</li>
                    <li>total stok</li>
                    <li>total nilai transaksi</li>
                </ul>
                <br>

                Begitu ada kata total / jumlah uang / akumulasi <br>
                ‚û°Ô∏è <code>SUM()</code> langsung kepikiran</p>

                <br> <hr> <br>

                <h3>B. üîß SINTAKS DASAR</h3>
<pre>
    SUM(nama_kolom)
</pre>

                <p>üìå Catatan:
                <ul>
                    <li>kolom HARUS numerik</li>
                    <li>nilai <code>NULL</code> diabaikan</li>
                </ul></p>
                

                

                <br> <hr> <br>

                <h3>C. ‚úÖ CONTOH TABEL (orders)</h3>
                <table>
                    <tr>
                        <th>id</th>
                        <th>user_id</th>
                        <th>total</th>
                        <th>status</th>
                    </tr>
                    <tr>
                        <td class="ct">1</td>
                        <td class="ct">1</td>
                        <td class="ct">100000</td>
                        <td class="ct">paid</td>
                    </tr>
                    <tr>
                        <td class="ct">2</td>
                        <td class="ct">1</td>
                        <td class="ct">150000</td>
                        <td class="ct">paid</td>
                    </tr>
                    <tr>
                        <td class="ct">3</td>
                        <td class="ct">2</td>
                        <td class="ct">200000</td>
                        <td class="ct">unpaid</td>
                    </tr>
                    <tr>
                        <td class="ct">4</td>
                        <td class="ct">3</td>
                        <td class="ct"><code>NULL</code></td>
                        <td class="ct">paid</td>
                    </tr>
                </table>

                <br> <hr> <br>

                <h3>üîπ 1. SUM dasar</h3>
<pre>
    SELECT SUM(total) FROM orders;
</pre>

                <p>üß† Artinya:

                <div class="quote"><p>‚ÄúTotal nilai semua order?‚Äù</p></div>

                üìå Hasil:</p>
<pre>
    450000
</pre>

                <p>(<code>NULL</code> tidak dihitung)</p>

                <br> <hr> <br>

                <h3>üîπ 2. SUM + WHERE (paling sering)</h3>
<pre>
    SELECT SUM(total) <br>
    FROM orders <br>
    WHERE status = 'paid';
</pre>

                <p>üß† Artinya:

                <div class="quote"><p>‚ÄúTotal uang dari order yang sudah dibayar?‚Äù</p></div>

                üìå Hasil:</p>
<pre>
    250000
</pre>

                <p>‚û°Ô∏è <code>WHERE</code> dulu ‚Üí baru <code>SUM</code></p>

                <br> <hr> <br>

                <h3>üîπ 3. SUM + JOIN (real project)</h3>

                <p>Misal:  
                <ul>
                    <li>users</li>
                    <li>orders</li>
                </ul></p>
                <br>
<pre>
    SELECT users.name, SUM(orders.total) AS total_belanja <br>
    FROM users <br>
    JOIN orders ON users.id = orders.user_id <br>
    GROUP BY users.id;
</pre>

                <p>üìå Output:</p>
                <table>
                    <tr>
                        <th>name</th>
                        <th>total_belanja</th>
                    </tr>
                    <tr>
                        <td>Andi</td>
                        <td>250000</td>
                    </tr>
                    <tr>
                        <td>Budi</td>
                        <td>200000</td>
                    </tr>
                </table> <br>
                	
                <p>‚ö†Ô∏è Perhatikan:
                <ul>
                    <li>Begitu ada <code>SUM()</code></li>
                    <li>kolom lain WAJIB <code>GROUP BY</code></li>
                </ul> <br>

                (ini jembatan ke materi berikutnya üëÄ)</p>

                <br> <hr> <br>

                <h3>üîπ 4. SUM kolom hasil perhitungan</h3>
<pre>
    SELECT SUM(price * qty) AS total_penjualan <br>
    FROM order_items;
</pre>

                <p>üß† Artinya:

                <div class="quote"><p>‚ÄúTotal omzet dari semua item?‚Äù</p></div>

                üî• Ini sering dipakai di:
                <ul>
                    <li>invoice</li>
                    <li>laporan penjualan</li>
                    <li>laporan keuangan</li>
                </ul></p>

                <br> <hr> <br>

                <h3>E. ‚ö†Ô∏è HAL PENTING TENTANG SUM()</h3>
                <p>‚ùå SALAH</p>
<pre>
    SELECT name, SUM(total) <br>
    FROM orders;
</pre>

                <p>‚û°Ô∏è Error (karena name tidak di GROUP BY) <br> <br>

                ‚úÖ BENAR</p>
<pre>
    SELECT user_id, SUM(total) <br>
    FROM orders <br>
    GROUP BY user_id;
</pre>
                <br> <hr> <br>

                <h3>F. üß™ USE CASE NYATA SUM()</h3>
                <ul>
                    <li>Total omzet per hari</li>
                    <li>Total pengeluaran per bulan</li>
                    <li>Total stok per gudang</li>
                    <li>Total penjualan per produk</li>
                </ul>

                <br> <hr> <br>

                <h3>G. üß† RANGKUMAN SUM()</h3>
                <ul>
                    <li><code>SUM()</code> ‚Üí menjumlahkan nilai numerik</li>
                    <li><code>NULL</code> diabaikan</li>
                </ul> <br>
                
                <p>Hampir selalu dipakai barengan:
                <ul>
                    <li><code>WHERE</code></li>
                    <li><code>JOIN</code></li>
                    <li><code>GROUP BY</code></li>
                </ul></p>

                <br> <br>

                <hr> 

                <br> <br>

                <h2>3.3.3 AVG() ‚Äî rata-rata (harga, transaksi, nilai)</h2>

                <h3>A. APA ITU AVG()?</h3>

                <div class="quote"><p><code>AVG()</code> adalah aggregate function untuk: <br> <br>

                menghitung nilai rata-rata (mean) dari kolom numerik</p></div> <br>

                <p>Rumus di balik layar:</p>
<pre>
    AVG = SUM(nilai) / COUNT(nilai)
</pre>

                <p>üìå Catatan penting:
                <ul>
                    <li>hanya hitung nilai numerik</li>
                    <li><code>NULL</code> diabaikan</li>
                    <li>hasilnya bisa decimal</li>
                </ul></p>
                
                <br> <hr> <br>

                <h3>B. üß† CARA BERPIKIR AVG()</h3>

                <p>Biasanya muncul pertanyaan:
                <ul>
                    <li>rata-rata harga produk?</li>
                    <li>rata-rata transaksi per user?</li>
                    <li>rata-rata pengeluaran per hari?</li>
                    <li>rata-rata nilai penjualan?</li>
                </ul> <br>
                
                Begitu ada kata rata-rata / average / mean <br>
                ‚û°Ô∏è <code>AVG()</code></p>

                <br> <hr> <br>

                <h3>C. üîß SINTAKS DASAR</h3>
<pre>
    AVG(nama_kolom)
</pre>
                <h3>D. ‚úÖ CONTOH TABEL (orders)</h3>
                <table>
                    <tr>
                        <th>id</th>
                        <th>user_id</th>
                        <th>total</th>
                        <th>status</th>
                    </tr>
                    <tr>
                        <td class="ct">1</td>
                        <td class="ct">1</td>
                        <td class="ct">100000</td>
                        <td class="ct">paid</td>
                    </tr>
                    <tr>
                        <td class="ct">2</td>
                        <td class="ct">1</td>
                        <td class="ct">150000</td>
                        <td class="ct">paid</td>
                    </tr>
                    <tr>
                        <td class="ct">3</td>
                        <td class="ct">2</td>
                        <td class="ct">200000</td>
                        <td class="ct">paid</td>
                    </tr>
                    <tr>
                        <td class="ct">4</td>
                        <td class="ct">3</td>
                        <td class="ct"><code>NULL</code></td>
                        <td class="ct">paid</td>
                    </tr>
                </table>

                <br> <hr> <br>

                <h3>üîπ 1. AVG dasar</h3>
<pre>
    SELECT AVG(total) FROM orders;
</pre>

                <p>üìå Perhitungan:</p>
<pre>
    (100000 + 150000 + 200000) / 3 = 150000
</pre>

                ‚û°Ô∏è <code>NULL</code> tidak dihitung

                <br> <hr> <br>

                <h3>üîπ 2. AVG + WHERE (real use case)</h3>
<pre>
    SELECT AVG(total) <br>
    FROM orders <br>
    WHERE status = 'paid';
</pre>

                <p>üß† Artinya:</p>

                <div class="quote"><p>‚ÄúRata-rata nilai order yang sudah dibayar?‚Äù</p></div>

                <br> <hr> <br>

                <h3>üîπ 3. AVG per grup (AVG + GROUP BY)</h3>
<pre>
    SELECT user_id, AVG(total) AS rata_rata_order <br>
    FROM orders <br>
    GROUP BY user_id;
</pre>

                <p>üìå Output:</p>
<pre>
    <table>
        <tr>
            <th>user_id</th>
            <th>rata_rata_order</th>
        </tr>
        <tr>
            <td class="ct">1</td>
            <td>125000</td>
        </tr>
        <tr>
            <td class="ct">2</td>
            <td>200000</td>
        </tr>
    </table>
</pre>

                <p>‚û°Ô∏è User 3 tidak muncul karena semua total-nya <code>NULL</code></p>

                <br> <hr> <br>

                <h3>üîπ 4. AVG dari hasil perhitungan</h3>
<pre>
    SELECT AVG(price * qty) AS avg_item_value <br>
    FROM order_items;
</pre>

                <p>üß† Artinya:</p>

                <div class="quote"><p>‚ÄúRata-rata nilai per item order?‚Äù</p></div>

                <p>üî• sering dipakai di:
                <ul>
                    <li>analisis produk</li>
                    <li>pricing strategy</li>
                    <li>evaluasi diskon</li>
                </ul></p>

                <br> <hr> <br>

                <h3>E. ‚ö†Ô∏è PERANGKAP UMUM AVG()</h3>
                <p>‚ùå SALAH PIKIR</p>

                <div class="quote"><p>‚ÄúAVG itu total dibagi jumlah baris‚Äù</p></div> <br>

                <p>‚ùå SALAH <br> <br>
                Yang benar: </p>

                <div class="quote"><p>AVG = SUM(nilai) / COUNT(nilai yang tidak NULL)</p></div>

                <br> <hr> <br>

                <h3>F. ‚ùå ERROR SQL</h3>
<pre>
    SELECT name, AVG(total) <br>
    FROM orders;
</pre>

                <p>‚û°Ô∏è Error (kolom non-aggregate tanpa GROUP BY) <br> <br>

                ‚úÖ BENAR</p>
<pre>
    SELECT user_id, AVG(total) <br>
    FROM orders <br>
    GROUP BY user_id;
</pre>
                <br> <hr> <br>

                <h3>G. üß† AVG vs SUM vs COUNT</h3>
                <table>
                    <tr>
                        <th>Fungsi</th>
                        <th>Jawab pertanyaan</th>
                    </tr>
                    <tr>
                        <td><code>COUNT</code></td>
                        <td>ada berapa?</td>
                    </tr>
                    <tr>
                        <td><code>SUM</code></td>
                        <td>total berapa?</td>
                    </tr>
                    <tr>
                        <td><code>AVG</code></td>
                        <td>rata-rata berapa?</td>
                    </tr>
                </table> <br>
                	
                <p>üî• Ketiganya sering dipakai barengan</p>

                <br> <hr> <br>

                <h3>H. üß™ USE CASE NYATA</h3>
                <ul>
                    <li>Rata-rata transaksi harian</li>
                    <li>Rata-rata penjualan per produk</li>
                    <li>Rata-rata pengeluaran per user</li>
                    <li>Rata-rata nilai invoice</li>
                </ul>
                
                <br> <hr> <br>

                <h3>I. üß† RANGKUMAN AVG()</h3>
                <ul>
                    <li><code>AVG()</code> menghitung rata-rata</li>
                    <li><code>NULL</code> diabaikan</li>
                </ul> <br> <br>
                
                <p>Biasanya dipakai dengan:
                <ul>
                    <li><code>WHERE</code></li>
                    <li><code>GROUP BY</code></li>
                    <li><code>JOIN</code></li>
                </ul> <br>

                Hasil sering decimal</p>

                <br> <br> 

                <hr> 

                <br> <br>

                <h2>3.3.4 GROUP BY ‚Äî jantung aggregate SQL</h2>

                <h3>A. APA ITU GROUP BY?</h3>

                <div class="quote"><p><code>GROUP BY</code> dipakai untuk: <br> <br>

                mengelompokkan baris berdasarkan satu atau lebih kolom, lalu menghitung aggregate per kelompok</p></div> <br> <br>

                <p>Tanpa <code>GROUP BY</code>:
                <ul>
                    <li><code>SUM</code>, <code>COUNT</code>, <code>AVG</code> ‚Üí 1 baris hasil</li>
                </ul> <br> <br>
                

                Dengan <code>GROUP BY</code>:
                <ul>
                    <li>aggregate ‚Üí per grup</li>
                </ul></p>

                <br> <hr> <br>

                <h3>B. üß† CARA BERPIKIR GROUP BY</h3>

                <p>Pola pikirnya gini:</p>

                <div class="quote"><p>‚ÄúHitung sesuatu untuk setiap X‚Äù</p></div> <br>

                <p>Contoh:
                <ul>
                    <li>total penjualan per user</li>
                    <li>jumlah order per status</li>
                    <li>rata-rata harga per produk</li>
                    <li>total transaksi per bulan</li>
                </ul> <br>
                
                ‚û°Ô∏è bagian ‚Äúper ‚Ä¶‚Äù =<code>GROUP BY</code> </p>

                <br> <hr> <br>

                <h3>C. üîß SINTAKS DASAR</h3>
<pre>
    SELECT kolom_group, AGGREGATE(kolom) <br>
    FROM tabel <br>
    GROUP BY kolom_group;
</pre>
                <br> <hr> <br>

                <h3>D. ‚úÖ CONTOH TABEL (orders)</h3>
                <table>
                    <tr>
                        <th>id</th>
                        <th>user_id</th>
                        <th>total</th>
                        <th>status</th>
                    </tr>
                    <tr>
                        <td class="ct">1</td>
                        <td class="ct">1</td>
                        <td class="ct">100000</td>
                        <td class="ct">paid</td>
                    </tr>
                    <tr>
                        <td class="ct">2</td>
                        <td class="ct">1</td>
                        <td class="ct">150000</td>
                        <td class="ct">paid</td>
                    </tr>
                    <tr>
                        <td class="ct">3</td>
                        <td class="ct">2</td>
                        <td class="ct">200000</td>
                        <td class="ct">unpaid</td>
                    </tr>
                    <tr>
                        <td class="ct">4</td>
                        <td class="ct">2</td>
                        <td class="ct"><code>NULL</code></td>
                        <td class="ct">paid</td>
                    </tr>
                </table>

                <br> <hr> <br>

                <h3>üîπ 1. GROUP BY paling dasar</h3>
<pre>
    SELECT user_id, SUM(total) AS total_belanja <br>
    FROM orders <br>
    GROUP BY user_id;
</pre> <br>

                <p>üìå Output:</p>
<pre>
    <table>
        <tr>
            <th>user_id</th>
            <th>total_belanja</th>
        </tr>
        <tr>
            <td class="ct">1</td>
            <td class="ct">250000</td>
        </tr>
        <tr>
            <td class="ct">2</td>
            <td class="ct">500000</td>
        </tr>
    </table>
</pre> <br> <br>

                <p>üß† Artinya:</p>

                <div class="quote"><p>‚ÄúTotal belanja per user‚Äù</p></div>

                <br> <hr> <br>

                <h3>üîπ 2. GROUP BY + COUNT</h3>
<pre>
    SELECT status, COUNT(*) AS jumlah_order <br>
    FROM orders <br>
    GROUP BY status;
</pre>

                <p>üìå Output:</p>
<pre>
    <table>
        <tr>
            <th>status</th>
            <th>jumlah_order</th>
        </tr>
        <tr>
            <td class="ct">paid</td>
            <td class="ct">3</td>
        </tr>
        <tr>
            <td class="ct">unpaid</td>
            <td class="ct">1</td>
        </tr>
    </table>
</pre>

                <br> <hr> <br>

                <h3>üîπ 3. GROUP BY + AVG</h3>
<pre>
    SELECT user_id, AVG(total) AS rata_rata_order  <br>
    FROM orders <br>
    GROUP BY user_id;
</pre>
                <br> <hr> <br>

                <h3>‚ö†Ô∏è ATURAN EMAS GROUP BY (WAJIB HAFAL)</h3>

                <div class="quote"><p>SETIAP kolom di <code>SELECT</code> yang BUKAN aggregate <br>
                HARUS ada di <code>GROUP BY</code></p></div> <br>

                <p>‚ùå SALAH</p>
<pre>
    SELECT user_id, status, SUM(total) <br>
    FROM orders <br>
    GROUP BY user_id;
</pre>

                <p>‚û°Ô∏è Error (status tidak di <code>GROUP BY</code>) <br> <br>

                ‚úÖ BENAR (opsi 1)</p>
<pre>
    SELECT user_id, status, SUM(total) <br>
    FROM orders <br>
    GROUP BY user_id, status;
</pre> <br> <br>
                
                <p>‚úÖ BENAR (opsi 2 ‚Äì logis)</p>
<pre>
    SELECT user_id, SUM(total) <br>
    FROM orders <br>
    GROUP BY user_id;
</pre>
                <br> <hr> <br>

                <h3>üîπ 4. GROUP BY lebih dari satu kolom</h3>
<pre>
    SELECT user_id, status, COUNT(*) AS total <br>
    FROM orders <br>
    GROUP BY user_id, status;
</pre>

                <p>üìå Output:</p>
<pre>
    <table>
        <tr>
            <th>user_id</th>
            <th>status</th>
            <th>total</th>
        </tr>
        <tr>
            <td class="ct">1</td>
            <td class="ct">paid</td>
            <td class="ct">2</td>
        </tr>
        <tr>
            <td class="ct">2</td>
            <td class="ct">paid</td>
            <td class="ct">1</td>
        </tr>
        <tr>
            <td class="ct">2</td>
            <td class="ct">unpaid</td>
            <td class="ct">1</td>
        </tr>
    </table>
</pre>
                <br> <hr> <br>

                <h3>üîπ 5. GROUP BY + WHERE (urutan logika penting)</h3>
<pre>
    SELECT user_id, SUM(total) <br>
    FROM orders <br>
    WHERE status = 'paid' <br>
    GROUP BY user_id;
</pre>

                <p>üß† Urutan berpikir:
                <ul>
                    <li><code>WHERE</code> ‚Üí filter baris</li>
                    <li><code>GROUP BY</code> ‚Üí kelompokkan</li>
                    <li><code>SUM()</code> ‚Üí hitung per kelompok</li>
                </ul></p>

                <br> <hr> <br>

                <h3>üîπ 6. GROUP BY + JOIN (REAL PROJECT)</h3>
<pre>
    SELECT users.name, SUM(orders.total) AS total_belanja <br>
    FROM users <br>
    JOIN orders ON users.id = orders.user_id <br>
    GROUP BY users.id, users.name;
</pre>

                <p>üî• Ini bentuk laporan klasik:
                <ul>
                    <li>user</li>
                    <li>total transaksi</li>
                </ul></p>

                <br> <hr> <br>

                <h3>E. üß† GROUP BY ‚â† ORDER BY</h3>
                <table>
                    <tr>
                        <th><code>GROUP BY</code></th>
                        <th><code>ORDER BY</code></th>
                    </tr>
                    <tr>
                        <td>Mengelompokkan data	</td>
                        <td>Mengurutkan hasil</td>
                    </tr>
                    <tr>
                        <td>Untuk aggregate</td>
                        <td>Untuk tampilan</td>
                    </tr>
                    <tr>
                        <td>Wajib untuk aggregate per grup</td>
                        <td>Opsional</td>
                    </tr>
                </table>

                <br> <hr> <br>

                <h3>F. üß™ USE CASE NYATA GROUP BY</h3>
                <ul>
                    <li>Laporan penjualan per hari</li>
                    <li>KPI per departemen</li>
                    <li>Omzet per produk</li>
                    <li>Jumlah user per role</li>
                    <li>Statistik bulanan</li>
                </ul>
                
                <br> <hr> <br>

                <h3>G. üß† RANGKUMAN GROUP BY</h3>

                <div class="quote"><p>GROUP BY = pengelompokan data</p></div> <br>

                <p>Dipakai bersama:
                <ul>
                    <li><code>SUM</code></li>
                    <li><code>COUNT</code></li>
                    <li><code>AVG</code></li>
                </ul>
                
                <br>

                <ul>
                    <li>Semua kolom non-aggregate WAJIB di GROUP BY</li>
                    <li>Ini fondasi laporan & analytics</li>
                </ul></p>

                <br> <br>

                <hr>

                <br> <br>

                <h2>3.3.5 ‚Äî HAVING (WHERE-nya aggregate)</h2>

                <h3>A. üî∞ APA ITU HAVING?</h3>

                <div class="quote"><p><code>HAVING</code> dipakai untuk:

                memfilter HASIL <code>GROUP BY</code> (hasil aggregate)</p></div>

                <p>üìå Ringkasnya:
                <ul>
                    <li><code>WHERE</code> ‚Üí filter baris</li>
                    <li><code>HAVING</code> ‚Üí filter grup</li>
                </ul></p>
                
                <br> <hr> <br>

                <h3>B. üß† CARA BERPIKIR HAVING</h3>

                <p>Kalau kamu mikir:
                <ul>
                    <li>‚ÄúTampilkan user yang total belanjanya > 1 juta‚Äù</li>
                    <li>‚ÄúProduk yang terjual lebih dari 100 kali‚Äù</li>
                    <li>‚ÄúKategori dengan rata-rata harga di atas 50 ribu‚Äù</li>
                </ul> <br>
                
                ‚û°Ô∏è itu HAVING, bukan WHERE</p>

                <br> <hr> <br>

                <h3>C. üß© URUTAN EKSEKUSI SQL (PENTING)</h3>
<pre>
    FROM <br>
    ‚Üí WHERE <br>
    ‚Üí GROUP BY <br>
    ‚Üí HAVING <br>
    ‚Üí SELECT <br>
    ‚Üí ORDER BY
</pre>

                <p>üî• Ini alasan WHERE tidak bisa pakai SUM()</p>

                <br> <hr> <br>

                <h3>D. üîß SINTAKS DASAR</h3>
<pre>
    SELECT kolom, AGGREGATE() <br>
    FROM tabel <br>
    GROUP BY kolom <br>
    HAVING kondisi_aggregate;
</pre>
                <br> <hr> <br>

                <h3>E. ‚úÖ CONTOH TABEL (orders)</h3>
                <table>
                    <tr>
                        <th>id</th>
                        <th>user_id</th>
                        <th>total</th>
                    </tr>
                    <tr>
                        <td class="ct">1</td>
                        <td class="ct">1</td>
                        <td class="ct">100000</td>
                    </tr>
                    <tr>
                        <td class="ct">2</td>
                        <td class="ct">1</td>
                        <td class="ct">150000</td>
                    </tr>
                    <tr>
                        <td class="ct">3</td>
                        <td class="ct">2</td>
                        <td class="ct">200000</td>
                    </tr>
                    <tr>
                        <td class="ct">4</td>
                        <td class="ct">3</td>
                        <td class="ct">50000</td>
                    </tr>
                </table>

                <br> <hr> <br>

                <h3>üîπ 1. HAVING paling dasar</h3>
<pre>
    SELECT user_id, SUM(total) AS total_belanja <br>
    FROM orders <br>
    GROUP BY user_id <br>
    HAVING SUM(total) > 200000;
</pre>
 <br>

                <p>üìå Output:</p>
<pre>
    <table>
        <tr>
            <th>user_id</th>
            <th>total_belanja</th>
        </tr>
        <tr>
            <td class="ct">1</td>
            <td class="ct">250000</td>
        </tr>
        <tr>
            <td class="ct">2</td>
            <td class="ct">200000 ‚ùå (tidak masuk karena tidak > 200000)</td>
        </tr>
    </table>
</pre>

                <div class="quote"><p>‚ÄúUser dengan total belanja lebih dari 200 ribu‚Äù</p></div> <br>

                <p>‚ùå KESALAHAN PALING UMUM</p>
<pre>
    SELECT user_id, SUM(total) <br>
    FROM orders <br>
    WHERE SUM(total) > 200000 <br>
    GROUP BY user_id;
</pre>

                <p>üö´ ERROR <br>
                ‚û°Ô∏è <code>WHERE</code> tidak bisa pakai aggregate</p>

                <br> <hr> <br>

                <h3>üîπ 2. HAVING + COUNT</h3>
<pre>
    SELECT user_id, COUNT(*) AS jumlah_order <br>
    FROM orders <br>
    GROUP BY user_id <br>
    HAVING COUNT(*) >= 2;
</pre>

                <p>üß† Artinya:</p>

                <div class="quote"><p>‚ÄúUser yang order minimal 2 kali‚Äù</p></div>

                <br> <hr> <br>

                <h3>üîπ 3. HAVING + AVG</h3>
<pre>
    SELECT user_id, AVG(total) AS rata_rata <br>
    FROM orders <br>
    GROUP BY user_id <br>
    HAVING AVG(total) > 100000;
</pre>
                <br> <hr> <br>

                <h3>üîπ 4. WHERE + HAVING (kombinasi ideal)</h3>
<pre>
    SELECT user_id, SUM(total) AS total_paid <br>
    FROM orders <br>
    WHERE status = 'paid' <br>
    GROUP BY user_id <br>
    HAVING SUM(total) > 200000;
</pre> <br>

                <p>üß† Urutan logis:
                <ul>
                    <li><code>WHERE</code> ‚Üí ambil order paid saja</li>
                    <li><code>GROUP BY</code> ‚Üí kelompokkan per user</li>
                    <li><code>HAVING</code> ‚Üí filter user berdasarkan total</li>
                </ul> <br>

                üî• Ini bentuk query laporan paling sering di dunia nyata</p>

                <br> <hr> <br>

                <h3>üîπ 5. <code>HAVING</code> tanpa <code>GROUP BY</code> (boleh tapi jarang)</h3>
<pre>
    SELECT SUM(total) <br>
    FROM orders <br>
    HAVING SUM(total) > 1000000;
</pre> <br>

                <p>üìå Dipakai kalau mau:</p>

                <div class="quote"><p>‚ÄúTampilkan total jika memenuhi syarat‚Äù</p></div>

                <br> <hr> <br>

                <h3>F. üß† WHERE vs HAVING (WAJIB PAHAM)</h3>
                <table>
                    <tr>
                        <th><code>WHERE</code></th>
                        <th><code>HAVING</code></th>
                    </tr>
                    <tr>
                        <td>Filter baris</td>
                        <td>Filter grup</td>
                    </tr>
                    <tr>
                        <td>Sebelum <code>GROUP BY</code></td>
                        <td>Setelah <code>GROUP BY</code></td>
                    </tr>
                    <tr>
                        <td>Tidak bisa aggregate</td>
                        <td>Bisa aggregate</td>
                    </tr>
                    <tr>
                        <td>Lebih cepat</td>
                        <td>Lebih mahal</td>
                    </tr>
                </table> <br>

                <p>üìå Gunakan WHERE dulu kalau bisa, HAVING hanya untuk aggregate</p>

                <br> <hr> <br>

                <h3>G. üß™ USE CASE NYATA</h3>
                <ul>
                    <li>Top customer berdasarkan total belanja</li>
                    <li>Produk dengan penjualan tinggi</li>
                    <li>Cabang dengan performa rendah</li>
                    <li>KPI threshold</li>
                </ul>

                <br> <hr> <br>

                <h3>H. üß† RANGKUMAN HAVING</h3>
                <ul>
                    <li><code>HAVING</code> = <code>WHERE</code> untuk aggregate</li>
                    <li>Dipakai SETELAH <code>GROUP BY</code></li>
                </ul> <br> <br>

                <p>Biasanya bareng:
                <ul>
                    <li><code>SUM</code></li>
                    <li><code>COUNT</code></li>
                    <li><code>AVG</code></li>
                </ul> <br>

                Jangan tukar fungsi <code>WHERE</code> & <code>HAVING</code></p>

                <br> <hr> <br>

                <h3>I. üéâ BAB 3 SELESAI!</h3>

                <p>Bro, kalau dirangkum:
                <ul>
                    <li>Relasi ‚Üí cara desain tabel</li>
                    <li><code>JOIN</code> ‚Üí cara baca data lintas tabel</li>
                    <li>Aggregate ‚Üí cara bikin laporan & insight</li>
                </ul> <br>
                
                üî• Ini titik naik level dari CRUD ke ANALYTICS</p>

                <a href="4a-normalisasi.html" class="btn-next">4a. Normalisasi</a>
                
            </div>
        </main>
    </div>

    <script>
        fetch('layout/aside.html').then(response => response.text()).then(data => {
            document.getElementById('aside').innerHTML = data;

            const currentPage = window.location.pathname.split('/').pop();
            const links = document.querySelectorAll('aside a');

            links.forEach(link => {
                if(link.getAttribute('href') == currentPage){
                    link.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>